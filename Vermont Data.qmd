---
title: "Vermont Data"
format: html
editor: visual
---

## Vermont Data Analysis

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Read Excel Sheet (Age Data)

```{r}
install.packages("readxl")
library(readxl)
data <- read_excel("Clean_Age_Data_Vermont_2020.xlsx")

```

```{r}
colnames(data)

```

## Calculations

```{r}
# Load packages
library(readxl)

# 1. Read Excel file
data <- read_excel("Clean_Age_Data_Vermont_2020.xlsx")

# 2. Ensure columns are numeric
data$Age <- as.numeric(data$Age)
data$Population <- as.numeric(data$Population)

# 3. Expand data according to Population
expanded_ages <- rep(data$Age, data$Population)

# 4. Calculate statistics
median_age <- median(expanded_ages)
iqr_age <- IQR(expanded_ages)
mean_age <- weighted.mean(data$Age, w = data$Population)
var_age <- sum(data$Population * (data$Age - mean_age)^2) / (sum(data$Population) - 1)  # sample variance
sd_age <- sqrt(var_age)

# 5. Print results
cat("Median age:", median_age, "\n")
cat("IQR:", iqr_age, "\n")
cat("Weighted mean:", mean_age, "\n")
cat("Sample variance:", var_age, "\n")
cat("Sample standard deviation:", sd_age, "\n")

```
